name: Atom Pull Requests
on: pull_request
jobs:
    Lint:
      name: Lint Codebase
      runs-on: ubuntu-18.04
      defaults:
        run:
          shell: bash
          working-directory: script
      steps:
        - name: Checkout Code
          uses: actions/checkout@v2
        - name: Install Script Dependencies
          run: npm install
        - name: Linting
          run: ./lint

    GetReleaseVersion:
      name: Get Release Version
      runs-on: ubuntu-18.04
      defaults:
        run:
          shell: bash
          working-directory: script/vsts
      needs: Lint
      outputs:
        releaseVersion: ${{steps.get-release-version.outputs.releaseVersion}}
      steps:
        - name: Checkout Code
          uses: actions/checkout@v2
        - name: Install Dependencies
          run: npm install
        - id: get-release-version
          name: Get Version
          run: node get-release-version.js

    macOSBuild:
      name: macOS Build
      runs-on: macos-10.15
      needs: GetReleaseVersion
      steps:
        - name: Checkout Code
          uses: actions/checkout@v2
        - name: Use Node Version 12.4.0
          uses: actions/setup-node@v2-beta
          with:
            node-version: '12.4.0'
        - name: Bootstrap
          run: script/bootstrap
        - name: Build
          run: script/build --no-bootstrap
